<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Login or Sign Up for ProfitLens AI">
    <title>Login - ProfitLens AI</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="navigation.css">
    <link rel="stylesheet" href="footer.css">
    <link rel="stylesheet" href="hover-effects.css">

    <style>
        .auth-container {
            min-height: calc(100vh - 200px);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
        }

        .auth-card {
            max-width: 450px;
            width: 100%;
        }

        .auth-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--color-border);
        }

        .auth-tab {
            flex: 1;
            padding: 1rem;
            background: none;
            border: none;
            color: var(--color-text-secondary);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: all var(--transition-fast);
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }

        .auth-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .password-toggle {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--color-text-tertiary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.25rem;
            transition: all var(--transition-fast);
        }

        .password-toggle:hover {
            color: var(--color-primary);
            transform: translateY(-50%) scale(1.1);
        }

        .password-strength {
            margin-top: 0.5rem;
            display: none;
        }

        .password-strength.active {
            display: block;
        }

        .strength-bar {
            height: 4px;
            background: var(--color-bg-secondary);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .strength-fill {
            height: 100%;
            transition: all var(--transition-base);
            width: 0%;
        }

        .strength-weak .strength-fill {
            width: 33%;
            background: #ef4444;
        }

        .strength-medium .strength-fill {
            width: 66%;
            background: #fbbf24;
        }

        .strength-strong .strength-fill {
            width: 100%;
            background: #34d399;
        }

        .strength-text {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
        }

        .strength-weak .strength-text {
            color: #ef4444;
        }

        .strength-medium .strength-text {
            color: #fbbf24;
        }

        .strength-strong .strength-text {
            color: #34d399;
        }

        .forgot-password {
            text-align: right;
            margin-top: 0.5rem;
        }

        .forgot-password a {
            color: var(--color-primary);
            font-size: var(--font-size-sm);
            text-decoration: none;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 1.5rem 0;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid var(--color-border);
        }

        .divider span {
            padding: 0 1rem;
            color: var(--color-text-tertiary);
            font-size: var(--font-size-sm);
        }

        .google-btn {
            width: 100%;
            padding: 0.75rem 1rem;
            background: white;
            color: #333;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: all var(--transition-base);
        }

        .google-btn:hover {
            background: var(--color-bg-secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <!-- Header -->
    <div id="header-placeholder"></div>

    <div class="auth-container">
        <div class="auth-card card">
            <div class="card-header" style="text-align: center;">
                <a href="index.html" class="navbar-brand" style="font-size: var(--font-size-3xl);">
                    ProfitLens AI
                </a>
                <p class="text-secondary" style="margin-top: 0.5rem;">Welcome back! Please login to continue.</p>
            </div>

            <div class="card-body">
                <!-- Auth Tabs -->
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')" data-i18n="auth.login">
                        Login
                    </button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')" data-i18n="auth.signup">
                        Sign Up
                    </button>
                    <button class="auth-tab" onclick="switchAuthTab('forgot')" style="display: none;" id="forgot-tab">
                        Reset Password
                    </button>
                </div>

                <!-- Login Form -->
                <form id="login-form" class="auth-form active" onsubmit="handleLogin(event)">
                    <!-- Google Login -->
                    <button type="button" class="google-btn" onclick="loginWithGoogle()">
                        <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg">
                            <g fill="#000" fill-rule="evenodd">
                                <path
                                    d="M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z"
                                    fill="#EA4335" />
                                <path
                                    d="M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z"
                                    fill="#4285F4" />
                                <path
                                    d="M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z"
                                    fill="#FBBC05" />
                                <path
                                    d="M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z"
                                    fill="#34A853" />
                            </g>
                        </svg>
                        Continue with Google
                    </button>

                    <div class="divider">
                        <span>OR</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="auth.email">Email</label>
                        <input type="email" class="form-input" id="login-email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group" style="position: relative;">
                        <label class="form-label" data-i18n="auth.password">Password</label>
                        <input type="password" class="form-input" id="login-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        <button type="button" class="password-toggle" onclick="togglePassword('login-password')"
                            title="Toggle password visibility">
                            üëÅÔ∏è
                        </button>
                    </div>

                    <div class="forgot-password">
                        <a href="#" onclick="switchAuthTab('forgot'); return false;">Forgot Password?</a>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1.5rem;">
                        <span data-i18n="auth.login">Login</span>
                    </button>
                </form>

                <!-- Signup Form -->
                <form id="signup-form" class="auth-form" onsubmit="handleSignup(event)">
                    <!-- Google Signup -->
                    <button type="button" class="google-btn" onclick="loginWithGoogle()">
                        <svg width="18" height="18" xmlns="http://www.w3.org/2000/svg">
                            <g fill="#000" fill-rule="evenodd">
                                <path
                                    d="M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z"
                                    fill="#EA4335" />
                                <path
                                    d="M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z"
                                    fill="#4285F4" />
                                <path
                                    d="M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z"
                                    fill="#FBBC05" />
                                <path
                                    d="M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z"
                                    fill="#34A853" />
                            </g>
                        </svg>
                        Sign up with Google
                    </button>

                    <div class="divider">
                        <span>OR</span>
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="auth.fullName">Full Name</label>
                        <input type="text" class="form-input" id="signup-fullname" required placeholder="John Doe">
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="auth.businessName">Business Name</label>
                        <input type="text" class="form-input" id="signup-businessname"
                            placeholder="Your Business (Optional)">
                    </div>

                    <div class="form-group">
                        <label class="form-label" data-i18n="auth.email">Email</label>
                        <input type="email" class="form-input" id="signup-email" required placeholder="your@email.com">
                    </div>

                    <div class="form-group" style="position: relative;">
                        <label class="form-label" data-i18n="auth.password">Password</label>
                        <input type="password" class="form-input" id="signup-password" required minlength="6"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        <button type="button" class="password-toggle" onclick="togglePassword('signup-password')"
                            title="Toggle password visibility">
                            üëÅÔ∏è
                        </button>
                    </div>

                    <!-- Password Strength Indicator -->
                    <div class="password-strength" id="password-strength">
                        <div class="strength-bar">
                            <div class="strength-fill"></div>
                        </div>
                        <div class="strength-text">Password strength: <span id="strength-label">-</span></div>
                    </div>

                    <div class="form-group" style="position: relative;">
                        <label class="form-label" data-i18n="auth.confirmPassword">Confirm Password</label>
                        <input type="password" class="form-input" id="signup-confirm-password" required minlength="6"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        <button type="button" class="password-toggle"
                            onclick="togglePassword('signup-confirm-password')" title="Toggle password visibility">
                            üëÅÔ∏è
                        </button>
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1.5rem;">
                        <span data-i18n="auth.signup">Sign Up</span>
                    </button>
                </form>

                <!-- Forgot Password Form -->
                <form id="forgot-form" class="auth-form" onsubmit="handleForgotPassword(event)">
                    <p class="text-secondary" style="margin-bottom: 1.5rem;">
                        Enter your email address and we'll send you a link to reset your password.
                    </p>

                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="forgot-email" required placeholder="your@email.com">
                    </div>

                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1.5rem;">
                        Send Reset Link
                    </button>

                    <div style="text-align: center; margin-top: 1rem;">
                        <a href="#" onclick="switchAuthTab('login'); return false;" class="text-secondary"
                            style="font-size: var(--font-size-sm);">
                            Back to Login
                        </a>
                    </div>
                </form>
            </div>

            <div class="card-footer" style="text-align: center;">
                <p class="text-secondary" style="font-size: var(--font-size-sm);">
                    By continuing, you agree to our <a href="terms-of-service.html">Terms of Service</a> and <a
                        href="privacy-policy.html">Privacy Policy</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="translations.js"></script>
    <script src="components.js"></script>
    <script src="prompts.js"></script>
    <script src="claude-api.js"></script>
    <script src="backend-api.js"></script>
    <script src="auth.js"></script>
    <script src="shared-components.js"></script>
    <script src="demo-data.js"></script>
    <script src="security.js"></script>
    <script src="geo-language.js"></script>
    <script src="email-service.js"></script>
    <script src="app.js"></script>

    <script>
        // Initialize security
        initializeSecurity();
        // Initialize email service
        initializeEmailService();
        // Initialize auto language detection
        initializeAutoLanguage();
        // Initialize header and footer
        initializeHeaderFooter('');
        // Initialize demo data (for developers only)
        initializeDemoData();

        // Switch between login, signup, and forgot password tabs
        function switchAuthTab(tab) {
            const tabs = document.querySelectorAll('.auth-tab');
            const forms = document.querySelectorAll('.auth-form');

            tabs.forEach(t => t.classList.remove('active'));
            forms.forEach(f => f.classList.remove('active'));

            if (tab === 'login') {
                tabs[0].classList.add('active');
                document.getElementById('login-form').classList.add('active');
            } else if (tab === 'signup') {
                tabs[1].classList.add('active');
                document.getElementById('signup-form').classList.add('active');
            } else if (tab === 'forgot') {
                document.getElementById('forgot-form').classList.add('active');
            }
        }

        // Toggle password visibility with eye icon
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;

            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = 'üôà'; // Closed eye
                button.title = 'Hide password';
            } else {
                input.type = 'password';
                button.textContent = 'üëÅÔ∏è'; // Open eye
                button.title = 'Show password';
            }
        }

        // Check password strength
        function checkPasswordStrength(password) {
            const strengthIndicator = document.getElementById('password-strength');
            const strengthLabel = document.getElementById('strength-label');

            if (!password) {
                strengthIndicator.classList.remove('active');
                return;
            }

            strengthIndicator.classList.add('active');

            let strength = 0;
            const checks = {
                length: password.length >= 8,
                lowercase: /[a-z]/.test(password),
                uppercase: /[A-Z]/.test(password),
                numbers: /\d/.test(password),
                special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
            };

            // Calculate strength
            if (checks.length) strength++;
            if (checks.lowercase) strength++;
            if (checks.uppercase) strength++;
            if (checks.numbers) strength++;
            if (checks.special) strength++;

            // Remove all strength classes
            strengthIndicator.classList.remove('strength-weak', 'strength-medium', 'strength-strong');

            // Apply appropriate class
            if (strength <= 2) {
                strengthIndicator.classList.add('strength-weak');
                strengthLabel.textContent = 'Weak üòü';
            } else if (strength <= 4) {
                strengthIndicator.classList.add('strength-medium');
                strengthLabel.textContent = 'Medium üòê';
            } else {
                strengthIndicator.classList.add('strength-strong');
                strengthLabel.textContent = 'Strong üòä';
            }
        }

        // Add password strength checking to signup password field
        document.addEventListener('DOMContentLoaded', function () {
            const signupPassword = document.getElementById('signup-password');
            if (signupPassword) {
                signupPassword.addEventListener('input', function () {
                    checkPasswordStrength(this.value);
                });
            }
        });

        // Handle login
        async function handleLogin(event) {
            event.preventDefault();

            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            const result = await authManager.login({ email, password });

            if (result.success) {
                toast.success(getTranslation(currentLanguage, 'auth.loginSuccess'));
                setTimeout(() => {
                    window.location.href = 'profit-analyzer.html';
                }, 1000);
            } else {
                toast.error(result.error);
            }
        }

        // Handle signup
        async function handleSignup(event) {
            event.preventDefault();

            const fullName = document.getElementById('signup-fullname').value;
            const businessName = document.getElementById('signup-businessname').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('signup-confirm-password').value;

            const result = await authManager.register({
                fullName,
                businessName,
                email,
                password,
                confirmPassword
            });

            if (result.success) {
                toast.success(getTranslation(currentLanguage, 'auth.signupSuccess'));
                setTimeout(() => {
                    window.location.href = 'profit-analyzer.html';
                }, 1000);
            } else {
                toast.error(result.error);
            }
        }

        // Handle forgot password
        async function handleForgotPassword(event) {
            event.preventDefault();

            const email = document.getElementById('forgot-email').value;

            // Save reset request
            const resetRequests = storage.get('passwordResets', []);
            const resetToken = generateId();

            resetRequests.push({
                email,
                token: resetToken,
                timestamp: new Date().toISOString(),
                used: false
            });

            storage.set('passwordResets', resetRequests);

            // Show success message
            toast.success('Password reset link sent to your email!');

            // In production, send actual email
            console.log(`Reset link: ${window.location.origin}/reset-password.html?token=${resetToken}`);

            // Switch back to login
            setTimeout(() => {
                switchAuthTab('login');
            }, 2000);
        }

        // Google Login (placeholder - requires OAuth setup)
        function loginWithGoogle() {
            toast.info('Google login coming soon! Please use email/password for now.');

            // In production, implement Google OAuth:
            // 1. Set up Google OAuth credentials
            // 2. Use Google Sign-In library
            // 3. Handle OAuth callback
            // 4. Create/login user with Google profile
        }

        // Redirect if already logged in
        if (authManager.isAuthenticated()) {
            window.location.href = 'profit-analyzer.html';
        }
    </script>
</body>

</html>